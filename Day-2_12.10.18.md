---
title: 'Day-2: 12 Oct, 2018'
author: "tiangsinf"
date: "10/12/2018"
output: 
  html_document: 
    keep_md: yes
---

```r
library(tidyverse)
library(ggvis)
```



```r
y = lm(wt ~ mpg, mtcars) # deriving a linear regression
summary(y)
```

```
## 
## Call:
## lm(formula = wt ~ mpg, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.6516 -0.3490 -0.1381  0.3190  1.3684 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  6.04726    0.30869  19.590  < 2e-16 ***
## mpg         -0.14086    0.01474  -9.559 1.29e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.4945 on 30 degrees of freedom
## Multiple R-squared:  0.7528,	Adjusted R-squared:  0.7446 
## F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10
```

```r
# plot a linear regression using ggvis
mtcars %>%
  ggvis(~mpg, ~wt) %>%
  layer_points() %>%
  layer_model_predictions(model = "lm", se = TRUE)
```

```
## Guessing formula = wt ~ mpg
```

<!--html_preserve--><div id="plot_id788063904-container" class="ggvis-output-container">
<div id="plot_id788063904" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id788063904_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id788063904" data-renderer="svg">SVG</a>
 | 
<a id="plot_id788063904_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id788063904" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id788063904_download" class="ggvis-download" data-plot-id="plot_id788063904">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id788063904_spec = {
  "data": [
    {
      "name": ".0",
      "format": {
        "type": "csv",
        "parse": {
          "mpg": "number",
          "wt": "number"
        }
      },
      "values": "\"mpg\",\"wt\"\n21,2.62\n21,2.875\n22.8,2.32\n21.4,3.215\n18.7,3.44\n18.1,3.46\n14.3,3.57\n24.4,3.19\n22.8,3.15\n19.2,3.44\n17.8,3.44\n16.4,4.07\n17.3,3.73\n15.2,3.78\n10.4,5.25\n10.4,5.424\n14.7,5.345\n32.4,2.2\n30.4,1.615\n33.9,1.835\n21.5,2.465\n15.5,3.52\n15.2,3.435\n13.3,3.84\n19.2,3.845\n27.3,1.935\n26,2.14\n30.4,1.513\n15.8,3.17\n19.7,2.77\n15,3.57\n21.4,2.78"
    },
    {
      "name": ".0/model_prediction1",
      "format": {
        "type": "csv",
        "parse": {
          "resp_upr_": "number",
          "pred_": "number",
          "resp_lwr_": "number",
          "resp_": "number"
        }
      },
      "values": "\"resp_upr_\",\"pred_\",\"resp_lwr_\",\"resp_\"\n4.92423167107584,10.4,4.24034938250457,4.5822905267902\n4.87472704551332,10.6974683544304,4.20605005130783,4.54038854841058\n4.82529079557118,10.9949367088608,4.17168234449072,4.49848657003095\n4.77592776084939,11.2924050632911,4.13724142245326,4.45658459165132\n4.72664319458359,11.5898734177215,4.1027220319598,4.4146826132717\n4.67744280118112,11.8873417721519,4.06811846860303,4.37278063489207\n4.62833277657114,12.1848101265823,4.03342453645376,4.33087865651245\n4.5793198513061,12.4822784810127,3.99863350495955,4.28897667813282\n4.53041133623575,12.779746835443,3.96373806327064,4.2470746997532\n4.48161517041975,13.0772151898734,3.92873027232739,4.20517272137357\n4.43293997073885,13.3746835443038,3.89360151524904,4.16327074299394\n4.3843950823981,13.6721518987342,3.85834244683053,4.12136876461432\n4.33599062917672,13.9696202531646,3.82294294329267,4.07946678623469\n4.28773756185732,14.2670886075949,3.78739205385282,4.03756480785507\n4.23964770275426,14.5645569620253,3.75167795619662,3.99566282947544\n4.19173378365154,14.8620253164557,3.71578791854009,3.95376085109582\n4.14400947376203,15.1594936708861,3.67970827167035,3.91185887271619\n4.09648939354849,15.4569620253165,3.64342439512464,3.86995689433656\n4.04918910944346,15.7544303797468,3.60692072247042,3.82805491595694\n4.00212510373572,16.0518987341772,3.57018077141891,3.78615293757731\n3.95531471325757,16.3493670886076,3.5331872051378,3.74425095919769\n3.90877603015277,16.646835443038,3.49592193148336,3.70234898081806\n3.86252775810977,16.9443037974684,3.45836624676711,3.66044700243844\n3.81658901822384,17.2417721518987,3.42050102989378,3.61854502405881\n3.77097910032027,17.5392405063291,3.3823069910381,3.57664304567919\n3.72571715831247,17.8367088607595,3.34376497628665,3.53474106729956\n3.68082185206635,18.1341772151899,3.30485632577352,3.49283908891993\n3.63631094320887,18.4316455696203,3.26556327787175,3.45093711054031\n3.59220085802877,18.7291139240506,3.2258694062926,3.40903513216068\n3.54850623646924,19.026582278481,3.18576007109287,3.36713315378106\n3.50523949135192,19.3240506329114,3.14522285945094,3.32523117540143\n3.46241040540316,19.6215189873418,3.10424798864045,3.28332919702181\n3.42002579443663,19.9189873417722,3.06282864284773,3.24142721864218\n3.37808926254242,20.2164556962025,3.02096121798269,3.19952524026255\n3.33660106923961,20.5139240506329,2.97864545452624,3.15762326188293\n3.29555811981925,20.8113924050633,2.93588444718735,3.1157212835033\n3.25495407970474,21.1088607594937,2.89268453054261,3.07381930512368\n3.21477960313101,21.4063291139241,2.84905505035709,3.03191732674405\n3.17502265736812,21.7037974683544,2.80500803936073,2.99001534836443\n3.13566891733181,22.0012658227848,2.76055782263779,2.9481133699848\n3.09670220238871,22.2987341772152,2.71572058082164,2.90621139160517\n3.05810492747131,22.5962025316456,2.67051389897979,2.86430941322555\n3.0198585436984,22.8936708860759,2.62495632599344,2.82240743484592\n2.98194394863909,23.1911392405063,2.5790669642935,2.7805054564663\n2.94434185216187,23.4886075949367,2.53286510401147,2.73860347808667\n2.90703308958799,23.7860759493671,2.4863699098261,2.69670149970705\n2.86999887897764,24.0835443037975,2.4396001636772,2.65479952132742\n2.83322102345037,24.3810126582278,2.39257406244522,2.61289754294779\n2.79668206235869,24.6784810126582,2.34530906677765,2.57099556456817\n2.76036537695779,24.9759493670886,2.29782179541929,2.52909358618854\n2.72425525711594,25.273417721519,2.25012795850189,2.48719160780892\n2.6883369358048,25.5708860759494,2.20224232305378,2.44528962942929\n2.65259659781222,25.8683544303797,2.15417870428711,2.40338765104967\n2.61702136851916,26.1658227848101,2.10594997682092,2.36148567267004\n2.58159928782669,26.4632911392405,2.05756810075414,2.31958369429041\n2.54631927351531,26.7607594936709,2.00904415830627,2.27768171591079\n2.51117107753981,27.0582278481013,1.96038839752252,2.23577973753116\n2.47614523805103,27.3556962025316,1.91161028025205,2.19387775915154\n2.4412330293125,27.653164556962,1.86271853223132,2.15197578077191\n2.40642641115211,27.9506329113924,1.81372119363246,2.11007380239229\n2.37171797915338,28.2481012658228,1.76462566887194,2.06817182401266\n2.33710091644025,28.5455696202532,1.71543877482582,2.02626984563303\n2.30256894763198,28.8430379746835,1.66616678687484,1.98436786725341\n2.26811629533061,29.1405063291139,1.61681548241696,1.94246588887378\n2.23373763934051,29.4379746835443,1.56739018164781,1.90056391049416\n2.1994280786986,29.7354430379747,1.51789578553047,1.85866193211453\n2.16518309650617,30.0329113924051,1.46833681096364,1.81675995373491\n2.13099852749157,30.3303797468354,1.41871742321899,1.77485797535528\n2.0968705281911,30.6278481012658,1.36904146576022,1.73295599697566\n2.06279554960925,30.9253164556962,1.31931248758281,1.69105401859603\n2.02877031220397,31.2227848101266,1.26953376822883,1.6491520402164\n1.99479178303604,31.520253164557,1.21970834063751,1.60725006183678\n1.96085715492054,31.8177215189873,1.16983901199376,1.56534808345715\n1.92696382742198,32.1151898734177,1.11992838273308,1.52344610507753\n1.89310938954057,32.4126582278481,1.06997886385523,1.4815441266979\n1.85929160394516,32.7101265822785,1.01999269269139,1.43964214831828\n1.82550839261725,33.0075949367089,0.969971947260044,1.39774016993865\n1.7917578237801,33.3050632911392,0.919918559337943,1.35583819155902\n1.75803809999637,33.6025316455696,0.869834326362428,1.3139362131794\n1.72434754732717,33.9,0.819720922272377,1.27203423479977"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n9.225\n35.075"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n0.589506968385996\n5.65421395388638"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "symbol",
      "properties": {
        "update": {
          "fill": {
            "value": "#000000"
          },
          "size": {
            "value": 50
          },
          "x": {
            "scale": "x",
            "field": "data.mpg"
          },
          "y": {
            "scale": "y",
            "field": "data.wt"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0"
          }
        }
      },
      "from": {
        "data": ".0"
      }
    },
    {
      "type": "area",
      "properties": {
        "update": {
          "fill": {
            "value": "#333333"
          },
          "y2": {
            "scale": "y",
            "field": "data.resp_upr_"
          },
          "fillOpacity": {
            "value": 0.2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_lwr_"
          },
          "stroke": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction1"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction1"
      }
    },
    {
      "type": "line",
      "properties": {
        "update": {
          "stroke": {
            "value": "#000000"
          },
          "strokeWidth": {
            "value": 2
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          },
          "fill": {
            "value": "transparent"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/model_prediction1"
          }
        }
      },
      "from": {
        "data": ".0/model_prediction1"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true,
      "title": "mpg"
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true,
      "title": "wt"
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 672,
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id788063904").parseSpec(plot_id788063904_spec);
</script><!--/html_preserve-->

```r
# just line
mtcars %>%
  compute_model_prediction(wt~mpg, model = "lm") %>% 
  ggvis(~pred_, ~resp_) %>% 
  layer_lines()
```

<!--html_preserve--><div id="plot_id134695458-container" class="ggvis-output-container">
<div id="plot_id134695458" class="ggvis-output"></div>
<div class="plot-gear-icon">
<nav class="ggvis-control">
<a class="ggvis-dropdown-toggle" title="Controls" onclick="return false;"></a>
<ul class="ggvis-dropdown">
<li>
Renderer: 
<a id="plot_id134695458_renderer_svg" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id134695458" data-renderer="svg">SVG</a>
 | 
<a id="plot_id134695458_renderer_canvas" class="ggvis-renderer-button" onclick="return false;" data-plot-id="plot_id134695458" data-renderer="canvas">Canvas</a>
</li>
<li>
<a id="plot_id134695458_download" class="ggvis-download" data-plot-id="plot_id134695458">Download</a>
</li>
</ul>
</nav>
</div>
</div>
<script type="text/javascript">
var plot_id134695458_spec = {
  "data": [
    {
      "name": ".0/arrange1",
      "format": {
        "type": "csv",
        "parse": {
          "pred_": "number",
          "resp_": "number"
        }
      },
      "values": "\"pred_\",\"resp_\"\n10.4,4.5822905267902\n10.6974683544304,4.54038854841058\n10.9949367088608,4.49848657003095\n11.2924050632911,4.45658459165132\n11.5898734177215,4.4146826132717\n11.8873417721519,4.37278063489207\n12.1848101265823,4.33087865651245\n12.4822784810127,4.28897667813282\n12.779746835443,4.2470746997532\n13.0772151898734,4.20517272137357\n13.3746835443038,4.16327074299394\n13.6721518987342,4.12136876461432\n13.9696202531646,4.07946678623469\n14.2670886075949,4.03756480785507\n14.5645569620253,3.99566282947544\n14.8620253164557,3.95376085109582\n15.1594936708861,3.91185887271619\n15.4569620253165,3.86995689433656\n15.7544303797468,3.82805491595694\n16.0518987341772,3.78615293757731\n16.3493670886076,3.74425095919769\n16.646835443038,3.70234898081806\n16.9443037974684,3.66044700243844\n17.2417721518987,3.61854502405881\n17.5392405063291,3.57664304567919\n17.8367088607595,3.53474106729956\n18.1341772151899,3.49283908891993\n18.4316455696203,3.45093711054031\n18.7291139240506,3.40903513216068\n19.026582278481,3.36713315378106\n19.3240506329114,3.32523117540143\n19.6215189873418,3.28332919702181\n19.9189873417722,3.24142721864218\n20.2164556962025,3.19952524026255\n20.5139240506329,3.15762326188293\n20.8113924050633,3.1157212835033\n21.1088607594937,3.07381930512368\n21.4063291139241,3.03191732674405\n21.7037974683544,2.99001534836443\n22.0012658227848,2.9481133699848\n22.2987341772152,2.90621139160517\n22.5962025316456,2.86430941322555\n22.8936708860759,2.82240743484592\n23.1911392405063,2.7805054564663\n23.4886075949367,2.73860347808667\n23.7860759493671,2.69670149970705\n24.0835443037975,2.65479952132742\n24.3810126582278,2.61289754294779\n24.6784810126582,2.57099556456817\n24.9759493670886,2.52909358618854\n25.273417721519,2.48719160780892\n25.5708860759494,2.44528962942929\n25.8683544303797,2.40338765104967\n26.1658227848101,2.36148567267004\n26.4632911392405,2.31958369429041\n26.7607594936709,2.27768171591079\n27.0582278481013,2.23577973753116\n27.3556962025316,2.19387775915154\n27.653164556962,2.15197578077191\n27.9506329113924,2.11007380239229\n28.2481012658228,2.06817182401266\n28.5455696202532,2.02626984563303\n28.8430379746835,1.98436786725341\n29.1405063291139,1.94246588887378\n29.4379746835443,1.90056391049416\n29.7354430379747,1.85866193211453\n30.0329113924051,1.81675995373491\n30.3303797468354,1.77485797535528\n30.6278481012658,1.73295599697566\n30.9253164556962,1.69105401859603\n31.2227848101266,1.6491520402164\n31.520253164557,1.60725006183678\n31.8177215189873,1.56534808345715\n32.1151898734177,1.52344610507753\n32.4126582278481,1.4815441266979\n32.7101265822785,1.43964214831828\n33.0075949367089,1.39774016993865\n33.3050632911392,1.35583819155902\n33.6025316455696,1.3139362131794\n33.9,1.27203423479977"
    },
    {
      "name": "scale/x",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n9.225\n35.075"
    },
    {
      "name": "scale/y",
      "format": {
        "type": "csv",
        "parse": {
          "domain": "number"
        }
      },
      "values": "\"domain\"\n1.10652142020025\n4.74780334138972"
    }
  ],
  "scales": [
    {
      "name": "x",
      "domain": {
        "data": "scale/x",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "width"
    },
    {
      "name": "y",
      "domain": {
        "data": "scale/y",
        "field": "data.domain"
      },
      "zero": false,
      "nice": false,
      "clamp": false,
      "range": "height"
    }
  ],
  "marks": [
    {
      "type": "line",
      "properties": {
        "update": {
          "stroke": {
            "value": "#000000"
          },
          "x": {
            "scale": "x",
            "field": "data.pred_"
          },
          "y": {
            "scale": "y",
            "field": "data.resp_"
          }
        },
        "ggvis": {
          "data": {
            "value": ".0/arrange1"
          }
        }
      },
      "from": {
        "data": ".0/arrange1"
      }
    }
  ],
  "legends": [],
  "axes": [
    {
      "type": "x",
      "scale": "x",
      "orient": "bottom",
      "layer": "back",
      "grid": true
    },
    {
      "type": "y",
      "scale": "y",
      "orient": "left",
      "layer": "back",
      "grid": true
    }
  ],
  "padding": null,
  "ggvis_opts": {
    "keep_aspect": false,
    "resizable": true,
    "padding": {},
    "duration": 250,
    "renderer": "svg",
    "hover_duration": 0,
    "width": 672,
    "height": 480
  },
  "handlers": null
};
ggvis.getPlot("plot_id134695458").parseSpec(plot_id134695458_spec);
</script><!--/html_preserve-->
